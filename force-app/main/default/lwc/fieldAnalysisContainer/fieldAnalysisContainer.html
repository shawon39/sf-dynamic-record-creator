<template>
    <lightning-card title="Dynamic Field Analysis Wizard" icon-name="standard:process">
        <!-- Progress Indicator -->
        <div class="slds-var-p-horizontal_large slds-var-p-top_large slds-var-p-bottom_medium">
            <div class="slds-var-m-bottom_large">
                <lightning-progress-indicator current-step={currentStepNumber} type="base" variant="base">
                    <lightning-progress-step label="Object Selection" value="1"></lightning-progress-step>
                    <lightning-progress-step label="Field Analysis" value="2"></lightning-progress-step>
                    <lightning-progress-step label="Create Instructions" value="3"></lightning-progress-step>
                    <lightning-progress-step label="Review & Save" value="4"></lightning-progress-step>
                </lightning-progress-indicator>
            </div>
            
            <!-- Step Content -->
            <div class="slds-var-p-horizontal_medium">
                <!-- Step 1: Object Selection -->
                <template if:true={isStep1}>
                    <c-object-selector 
                        onobjectselected={handleObjectSelected}
                        onerror={handleError}>
                    </c-object-selector>
                </template>
                
                <!-- Step 2: Field Analysis -->
                <template if:true={isStep2}>
                    <c-field-selector 
                        selected-object={analysisData.selectedObject}
                        selected-record-type={analysisData.selectedRecordType}
                        selected-record-type-name={analysisData.selectedRecordTypeName}
                        onfieldsanalyzed={handleFieldsAnalyzed}
                        ongoback={handleGoBack}
                        onerror={handleError}>
                    </c-field-selector>
                </template>
                
                <!-- Step 3: Instruction Creation -->
                <template if:true={isStep3}>
                    <c-instruction-builder 
                        selected-object={analysisData.selectedObject}
                        selected-fields={analysisData.selectedFields}
                        oninstructionscreated={handleInstructionsCreated}
                        ongoback={handleGoBack}
                        onerror={handleError}>
                    </c-instruction-builder>
                </template>
                
                <!-- Step 4: Review & Save -->
                <template if:true={isStep4}>
                    <c-analysis-review 
                        analysis-data={analysisData}
                        onanalysissaved={handleAnalysisSaved}
                        ongoback={handleGoBack}
                        onstartover={handleStartOver}
                        onerror={handleError}>
                    </c-analysis-review>
                </template>
            </div>
        </div>
    </lightning-card>
</template>